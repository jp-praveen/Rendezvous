function [v1,v2,v1_norm,v2_norm] = prograde(r1,r2,transfer_time)
r1cr2=cross(r1,r2);
r1r2=norm(r1)*norm(r2);
if r1cr2(3,1)>=0;
    deltheta=acosd(dot(r1,r2)/r1r2);                                  % deltheta is change in true anomaly in transfer orbit or Transfer angle
else
    deltheta=360-acosd(dot(r1,r2)/r1r2);                              % deltheta is in degrees  
end    
A=sind(deltheta)*sqrt(r1r2/(1-cosd(deltheta))); 

% Starting Newtons method to evaluate the z (z is  related to semi major axis and universal anomaly) 

z=0;                                                     % Initializing z
S=(1/6)-(z/120)+(z^2/5040)-(z^3/362880)+(z^4/39916800);  % S and C are Stumpff Functions 
C=(1/2)-(z/24)+(z^2/720)-(z^3/40320)+(z^4/3628800);
r1n=norm(r1);
r2n=norm(r2);
del_t=dt;
y=r1n+r2n+A*((z*S-1)/C^0.5);
f=((y/C)^1.5)*S+A*(y^0.5)-(u^0.5)*del_t;
if z==0;
    f_dash=(sqrt(2)/40)*y^1.5+(A/8)*(sqrt(y)+A*sqrt(1/2*y));
else;
    f_dash=((y/C)^1.5)*((1/2*z)*(C-1.5*S/C)+(3*S^2)/(4*C)) + (A/8)*((3*S*sqrt(y)/C)+A*sqrt(C/y));
end    

while abs((f/f_dash))>0.01;
    z_f=z-f/f_dash;
    z=z_f;
    S=(1/6)-(z/120)+(z^2/5040)-(z^3/362880)+(z^4/39916800);   
    C=(1/2)-(z/24)+(z^2/720)-(z^3/40320)+(z^4/3628800);
    y=r1n+r2n+A*((z*S-1)/C^0.5);
    f=((y/C)^1.5)*S+A*(y^0.5)-(u^0.5)*del_t;
    if z==0;
        f_dash=(sqrt(2)/40)*y^1.5+(A/8)*(sqrt(y)+A*sqrt(1/2*y));
    else;
        f_dash=((y/C)^1.5)*((1/2*z)*(C-1.5*S/C)+(3*S^2)/(4*C)) + (A/8)*((3*S*sqrt(y)/C)+A*sqrt(C/y));
    end
end    
